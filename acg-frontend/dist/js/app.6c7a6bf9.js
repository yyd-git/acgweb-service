(function(){"use strict";var e={6479:function(e,t,o){var s=o(6848),r=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},a=[],n=o(1656),i={},l=(0,n.A)(i,r,a,!1,null,null,null),c=l.exports,u=o(6178),d=function(){var e=this,t=e._self._c;return t("div",{staticClass:"container"},[t("img",{staticClass:"anime-image",attrs:{src:"https://i.pinimg.com/originals/50/2f/5d/502f5d95c5f7a1b6e2e1eeb0f9e1d1c5.png",alt:"anime"}}),t("h1",[e._v("ç™»å½•")]),t("el-input",{staticClass:"input-box",attrs:{placeholder:"ç”¨æˆ·å"},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}}),t("el-input",{staticClass:"input-box",attrs:{placeholder:"å¯†ç ",type:"password"},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}}),t("el-button",{staticClass:"btn",attrs:{type:"primary"},on:{click:e.login}},[e._v("ç™»å½•")]),t("el-button",{staticClass:"toggle-btn",attrs:{type:"text"},on:{click:e.goRegister}},[e._v(" åŽ»æ³¨å†Œ ")]),t("div",{staticClass:"message",style:{color:e.messageColor}},[e._v(e._s(e.message))])],1)},p=[],m=(o(4114),o(4603),o(7566),o(8721),o(4373));const h=!0,g=m.A.create({baseURL:"http://localhost:8090",timeout:1e4,withCredentials:!0});g.interceptors.request.use(e=>{const t=localStorage.getItem("token");return t&&(e.headers.Authorization=`Bearer ${t.trim()}`),h&&(console.groupCollapsed(`%câž¡ï¸ ${e.method?.toUpperCase()} ${e.url}`,"color:#67C23A;font-weight:bold"),console.log("Request config:",e),console.groupEnd()),e},e=>Promise.reject(e)),g.interceptors.response.use(e=>(h&&(console.groupCollapsed(`%câ¬…ï¸ ${e.config.method?.toUpperCase()} ${e.config.url}`,"color:#409EFF;font-weight:bold"),console.log("Status:",e.status),console.log("Result:",e.data),console.groupEnd()),e.data),e=>(h&&(console.groupCollapsed(`%câŒ HTTP ERROR ${e.config?.url}`,"color:red;font-weight:bold"),console.log("Error:",e),console.groupEnd()),e.response&&401===e.response.status&&(alert("ç™»å½•å·²è¿‡æœŸæˆ–æœªç™»å½•ï¼Œè¯·é‡æ–°ç™»å½•"),localStorage.removeItem("token"),setTimeout(()=>{window.location.href="/login"},500)),Promise.reject(e)));var f=g,v={name:"LoginView",data(){return{username:"",password:"",message:"",messageColor:"red"}},methods:{async login(){if(!this.username||!this.password)return this.message="è¯·è¾“å…¥ç”¨æˆ·åå’Œå¯†ç ",void(this.messageColor="red");const e=new URLSearchParams({username:this.username,password:this.password});try{const t=await f.post("/user/login",e,{headers:{"Content-Type":"application/x-www-form-urlencoded"}});if(1===t.code&&"success"===t.msg){const e=t.data;localStorage.setItem("token",e),this.message="ç™»å½•æˆåŠŸ",this.messageColor="lightgreen",setTimeout(()=>{this.$router.push("/products")},800)}else this.message=t.msg||"ç™»å½•å¤±è´¥",this.messageColor="red"}catch(t){console.error(t),this.message="ç½‘ç»œé”™è¯¯ï¼Œè¯·é‡è¯•",this.messageColor="red"}},goRegister(){this.$router.push("/register")}}},C=v,b=(0,n.A)(C,d,p,!1,null,"0a5478ce",null),w=b.exports,y=function(){var e=this,t=e._self._c;return t("div",{staticClass:"container"},[t("img",{staticClass:"anime-image",attrs:{src:"https://i.pinimg.com/originals/50/2f/5d/502f5d95c5f7a1b6e2e1eeb0f9e1d1c5.png",alt:"anime"}}),t("h1",[e._v("æ³¨å†Œ")]),t("el-input",{staticClass:"input-box",attrs:{placeholder:"ç”¨æˆ·å"},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}}),t("el-input",{staticClass:"input-box",attrs:{placeholder:"å¯†ç ",type:"password"},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}}),t("el-button",{staticClass:"btn",attrs:{type:"primary"},on:{click:e.register}},[e._v("æ³¨å†Œ")]),t("el-button",{staticClass:"toggle-btn",attrs:{type:"text"},on:{click:e.goLogin}},[e._v("åŽ»ç™»å½•")]),t("div",{staticClass:"message",style:{color:e.messageColor}},[e._v(e._s(e.message))])],1)},$=[],_=(o(8335),{name:"RegisterView",data(){return{username:"",password:"",message:"",messageColor:"red"}},methods:{async register(){if(!this.username||!this.password)return this.message="è¯·è¾“å…¥ç”¨æˆ·åå’Œå¯†ç ",void(this.messageColor="red");const e="http://localhost:8090/user",t=new URLSearchParams({username:this.username,password:this.password});try{const o=await fetch(`${e}/register`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:t,credentials:"include"}),s=await o.text();let r;try{r=JSON.parse(s)}catch{return this.message="è¿”å›žéž JSON æ•°æ®: "+s,void(this.messageColor="red")}1===r.code?(this.message=r.msg,this.messageColor="lightgreen",setTimeout(()=>this.$router.push("/login"),1e3)):(this.message=r.msg,this.messageColor="red")}catch(o){console.error(o),this.message="ç½‘ç»œé”™è¯¯ï¼Œè¯·é‡è¯•",this.messageColor="red"}},goLogin(){this.$router.push("/login")}}}),P=_,k=(0,n.A)(P,y,$,!1,null,"f5e928f4",null),x=k.exports,S=function(){var e=this,t=e._self._c;return t("div",{style:e.bgStyle},[t("div",{staticClass:"page-container"},[t("el-card",{staticClass:"header-card",attrs:{shadow:"never"}},[t("h1",{staticClass:"main-title"},[e._v("ðŸŽŒ ACG äº§å“å±•ç¤º")]),t("p",{staticClass:"subtitle"},[e._v("å‘çŽ°ä½ æ„Ÿå…´è¶£çš„åŠ¨æ¼« / æ¼«ç”» / æ¸¸æˆ / è½»å°è¯´")])]),t("el-card",{staticClass:"search-card"},[t("el-form",{attrs:{inline:""}},[t("el-form-item",[t("el-input",{attrs:{placeholder:"æœç´¢äº§å“åç§°",clearable:"","prefix-icon":"el-icon-search"},model:{value:e.searchName,callback:function(t){e.searchName=t},expression:"searchName"}})],1),t("el-form-item",[t("el-select",{attrs:{placeholder:"å…¨éƒ¨åˆ†ç±»",clearable:""},model:{value:e.searchType,callback:function(t){e.searchType=t},expression:"searchType"}},[t("el-option",{attrs:{label:"åŠ¨æ¼«",value:"ANIME"}}),t("el-option",{attrs:{label:"æ¼«ç”»",value:"COMIC"}}),t("el-option",{attrs:{label:"è½»å°è¯´",value:"NOVEL"}}),t("el-option",{attrs:{label:"æ¸¸æˆ",value:"GAME"}})],1)],1),t("el-form-item",[t("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(t){return e.loadProducts(0)}}},[e._v(" æœç´¢ ")])],1),t("el-form-item",[t("el-button",{attrs:{type:"success",icon:"el-icon-plus"},on:{click:function(t){e.showAddDialog=!0}}},[e._v(" æ·»åŠ äº§å“ ")])],1)],1)],1),t("div",{staticClass:"card-list"},e._l(e.products,function(o){return t("el-card",{key:o.id,staticClass:"product-card",attrs:{shadow:"hover"}},[t("div",{staticClass:"card-click-overlay",on:{click:function(t){return e.onCardClick(o)}}}),t("div",{staticClass:"card-body"},[t("img",{staticClass:"cover",attrs:{src:e.getCoverUrl(o.coverPath)}}),t("div",{staticClass:"info"},[t("div",{staticClass:"title-row"},[t("h2",[e._v(e._s(o.name))]),t("el-tag",{attrs:{size:"mini",type:"success"}},[e._v(e._s(o.type))])],1),t("p",{staticClass:"score"},[e._v("â­ è¯„åˆ†ï¼š"+e._s(o.totalScore||0))]),t("p",{staticClass:"desc"},[e._v(e._s(o.description||"æš‚æ— ç®€ä»‹"))])])])])}),1),t("div",{staticClass:"pagination"},[t("el-pagination",{attrs:{background:"",layout:"prev, pager, next","current-page":e.currentPage+1,"page-size":e.pageSize,total:e.totalPages*e.pageSize},on:{"current-change":e.handlePageChange}})],1),t("el-dialog",{attrs:{title:"æ·»åŠ  ACG äº§å“",visible:e.showAddDialog,width:"600px"},on:{"update:visible":function(t){e.showAddDialog=t},close:e.resetForm}},[t("el-form",{ref:"addForm",attrs:{model:e.newProduct,"label-width":"120px"}},[t("el-form-item",{attrs:{label:"äº§å“åç§°",required:""}},[t("el-input",{model:{value:e.newProduct.name,callback:function(t){e.$set(e.newProduct,"name",t)},expression:"newProduct.name"}})],1),t("el-form-item",{attrs:{label:"äº§å“ç®€ä»‹"}},[t("el-input",{attrs:{type:"textarea"},model:{value:e.newProduct.description,callback:function(t){e.$set(e.newProduct,"description",t)},expression:"newProduct.description"}})],1),t("el-form-item",{attrs:{label:"äº§å“ç±»åž‹",required:""}},[t("el-select",{attrs:{placeholder:"è¯·é€‰æ‹©ç±»åž‹"},model:{value:e.newProduct.type,callback:function(t){e.$set(e.newProduct,"type",t)},expression:"newProduct.type"}},[t("el-option",{attrs:{label:"åŠ¨æ¼«",value:"ANIME"}}),t("el-option",{attrs:{label:"æ¼«ç”»",value:"COMIC"}}),t("el-option",{attrs:{label:"è½»å°è¯´",value:"NOVEL"}}),t("el-option",{attrs:{label:"æ¸¸æˆ",value:"GAME"}})],1)],1),t("el-form-item",{attrs:{label:"ä½œè€… / å¼€å‘å•†"}},[t("el-input",{attrs:{placeholder:"ä½œè€…/å¼€å‘å•†"},model:{value:e.newProduct.author,callback:function(t){e.$set(e.newProduct,"author",t)},expression:"newProduct.author"}})],1),t("el-form-item",{attrs:{label:"é›†æ•° / ç« èŠ‚ / å·æ•°"}},[t("el-select",{staticStyle:{width:"120px","margin-right":"10px"},attrs:{placeholder:"é€‰æ‹©ç±»åž‹"},model:{value:e.countType,callback:function(t){e.countType=t},expression:"countType"}},[t("el-option",{attrs:{label:"é›†æ•°",value:"episodeCount"}}),t("el-option",{attrs:{label:"ç« èŠ‚",value:"chapterCount"}}),t("el-option",{attrs:{label:"å·æ•°",value:"volumeCount"}})],1),t("el-input-number",{staticStyle:{width:"120px"},attrs:{placeholder:"æ•°é‡"},model:{value:e.newProduct[e.countType],callback:function(t){e.$set(e.newProduct,e.countType,t)},expression:"newProduct[countType]"}})],1),t("el-form-item",{attrs:{label:"å°é¢å›¾ç‰‡"}},[t("el-upload",{attrs:{"file-list":e.coverFileList,"on-change":e.handleCoverChange,"before-upload":e.beforeUpload,"auto-upload":!1,accept:"image/*","list-type":"picture"}},[t("el-button",{attrs:{size:"small",type:"primary"}},[e._v("é€‰æ‹©å›¾ç‰‡")])],1)],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.showAddDialog=!1}}},[e._v("å–æ¶ˆ")]),t("el-button",{attrs:{type:"primary"},on:{click:e.submitNewProduct}},[e._v("æäº¤")])],1)],1)],1)])},F=[],T=o.p+"img/bg.cc639148.jpg",A={data(){return{bgStyle:{backgroundImage:`url(${T})`,backgroundRepeat:"no-repeat",backgroundPosition:"center center",backgroundSize:"cover",minHeight:"100vh",padding:"40px 20px"},products:[],currentPage:0,totalPages:0,pageSize:6,searchName:"",searchType:"",defaultCover:"https://via.placeholder.com/150x220?text=No+Cover",gatewayUrl:"http://localhost:8090",showAddDialog:!1,countType:"episodeCount",newProduct:{name:"",description:"",type:"",author:"",episodeCount:null,chapterCount:null,volumeCount:null,coverFile:null},coverFileList:[]}},methods:{getCoverUrl(e){return e?e.startsWith("/")?`${this.gatewayUrl}${e}`:`${this.gatewayUrl}/${e}`:this.defaultCover},async loadProducts(e){this.currentPage=e;let t=`/acg-product/page?page=${e}&size=${this.pageSize}`;this.searchType&&(t+=`&type=${this.searchType}`),this.searchName&&(t+=`&name=${encodeURIComponent(this.searchName)}`);try{const e=await f.get(t);if(1!==e.code)return void this.$message.error(e.msg||"åŠ è½½å¤±è´¥");this.products=e.data.content||[],this.totalPages=e.data.totalPages||0}catch(o){this.$message.error("åŠ è½½å¤±è´¥")}},handlePageChange(e){this.loadProducts(e-1)},onCardClick(e){e.id?(this.$router.push({name:"product-detail",params:{id:e.id}}).catch(()=>this.$message.error("è·³è½¬å¤±è´¥")),this.$message.info(`ç‚¹å‡»äº†äº§å“ï¼š${e.name||"æœªçŸ¥"}`)):this.$message.warning("äº§å“ ID ä¸ºç©ºï¼Œæ— æ³•è·³è½¬")},handleCoverChange(e,t){this.newProduct.coverFile=e.raw,this.coverFileList=t},beforeUpload(){return!1},async submitNewProduct(){if(!this.newProduct.name)return void this.$message.warning("è¯·å¡«å†™äº§å“åç§°");if(!this.newProduct.type)return void this.$message.warning("è¯·é€‰æ‹©äº§å“ç±»åž‹");const e=new FormData;e.append("name",this.newProduct.name),e.append("type",this.newProduct.type),this.newProduct.description&&e.append("description",this.newProduct.description),this.newProduct.author&&e.append("author",this.newProduct.author),"episodeCount"===this.countType&&null!=this.newProduct.episodeCount&&e.append("episodeCount",this.newProduct.episodeCount),"chapterCount"===this.countType&&null!=this.newProduct.chapterCount&&e.append("chapterCount",this.newProduct.chapterCount),"volumeCount"===this.countType&&null!=this.newProduct.volumeCount&&e.append("volumeCount",this.newProduct.volumeCount),this.newProduct.coverFile&&e.append("coverFile",this.newProduct.coverFile);try{const t=await f.post("/acg-product",e);1===t.code?(this.$message.success("æ·»åŠ æˆåŠŸ"),this.showAddDialog=!1,this.loadProducts(0),this.resetForm()):this.$message.error(t.msg||"æ·»åŠ å¤±è´¥")}catch(t){this.$message.error("æ·»åŠ å¤±è´¥")}},resetForm(){this.newProduct={name:"",description:"",type:"",author:"",episodeCount:null,chapterCount:null,volumeCount:null,coverFile:null},this.countType="episodeCount",this.coverFileList=[]}},mounted(){this.loadProducts(0)}},O=A,I=(0,n.A)(O,S,F,!1,null,"84a90e56",null),R=I.exports,U=function(){var e=this,t=e._self._c;return t("div",{style:e.bgStyle},[t("div",{staticClass:"page-container"},[t("el-card",{staticClass:"header-card",attrs:{shadow:"never"}},[t("h1",{staticClass:"main-title"},[e._v(e._s(e.product?.name||"åŠ è½½ä¸­..."))]),e.product?t("div",{staticClass:"product-info"},[t("p",[e._v(" ç±»åž‹ï¼š"),t("el-tag",[e._v(e._s(e.product.type))])],1),t("p",[e._v("ä½œè€…/å¼€å‘å•†ï¼š"+e._s(e.product.author||"æœªçŸ¥"))]),t("p",[e._v("é›†æ•°/ç« èŠ‚/å·æ•°ï¼š"+e._s(e.product.countDisplay||"æš‚æ— "))])]):e._e()]),t("div",{staticClass:"resource-list"},[e._l(e.resources,function(o){return t("el-card",{key:o.id,staticClass:"resource-card",attrs:{shadow:"hover"}},[o.hasResource?t("div",{staticClass:"resource-info"},[t("p",[e._v("èµ„æºåç§°ï¼š"+e._s(o.name))]),t("p",[e._v("æè¿°ï¼š"+e._s(o.description||"æš‚æ— æè¿°"))]),t("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(t){return e.downloadResource(o.resourcePath,o.name)}}},[e._v(" ä¸‹è½½ ")])],1):t("div",{staticClass:"no-resource"},[e._v("æš‚æ— èµ„æº")])])}),t("el-button",{staticClass:"upload-btn",attrs:{type:"primary",icon:"el-icon-upload"},on:{click:e.openUploadDialog}},[e._v(" ä¸Šä¼ èµ„æº ")])],2),t("el-dialog",{attrs:{title:"ä¸Šä¼ èµ„æº",visible:e.uploadDialogVisible,width:"500px"},on:{"update:visible":function(t){e.uploadDialogVisible=t}}},[t("el-form",{attrs:{model:e.uploadForm,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"èµ„æºåç§°",required:""}},[t("el-input",{model:{value:e.uploadForm.name,callback:function(t){e.$set(e.uploadForm,"name",t)},expression:"uploadForm.name"}})],1),t("el-form-item",{attrs:{label:"èµ„æºæè¿°"}},[t("el-input",{attrs:{type:"textarea",rows:"3"},model:{value:e.uploadForm.description,callback:function(t){e.$set(e.uploadForm,"description",t)},expression:"uploadForm.description"}})],1),t("el-form-item",{attrs:{label:"èµ„æºæ–‡ä»¶",required:""}},[t("el-upload",{attrs:{action:e.fakeAction,"before-upload":e.beforeUpload,"show-file-list":!1}},[t("el-button",[e._v("é€‰æ‹©æ–‡ä»¶")])],1),e.uploadForm.file?t("span",[e._v(e._s(e.uploadForm.file.name))]):e._e()],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.uploadDialogVisible=!1}}},[e._v("å–æ¶ˆ")]),t("el-button",{attrs:{type:"primary"},on:{click:e.submitUpload}},[e._v("ç¡®å®šä¸Šä¼ ")])],1)],1),t("el-card",{staticClass:"rating-card common-card",attrs:{shadow:"hover"}},[t("p",[e._v("æˆ‘çš„è¯„åˆ†ï¼š")]),t("el-rate",{attrs:{max:10,"show-score":""},model:{value:e.userScore,callback:function(t){e.userScore=t},expression:"userScore"}}),t("div",{staticClass:"btn-container"},[t("el-button",{attrs:{type:"primary"},on:{click:e.submitScore}},[e._v("æäº¤è¯„åˆ†")])],1)],1),t("el-card",{staticClass:"comment-card common-card",attrs:{shadow:"hover"}},[t("el-input",{attrs:{type:"textarea",placeholder:"å†™ä¸‹ä½ çš„è¯„è®º...",rows:"3"},model:{value:e.newComment,callback:function(t){e.newComment=t},expression:"newComment"}}),t("div",{staticClass:"btn-container"},[t("el-button",{attrs:{type:"primary"},on:{click:e.submitComment}},[e._v("å‘é€")])],1)],1),t("div",{staticClass:"comment-list"},e._l(e.comments,function(o){return t("el-card",{key:o.id,staticClass:"comment-item",attrs:{shadow:"hover"}},[t("p",{staticClass:"comment-username"},[e._v(e._s(o.username)+"ï¼š")]),t("p",{staticClass:"comment-content"},[e._v(e._s(o.content))])])}),1)],1)])},D=[];o(8111),o(1701),o(4979);function N(){const e=localStorage.getItem("token");if(!e)return null;try{const t=e.split(".")[1],o=JSON.parse(decodeURIComponent(atob(t).split("").map(e=>"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)).join("")));return o.userId||null}catch(t){return console.error("è§£æž token å¤±è´¥",t),null}}var E={props:["id"],data(){return{bgStyle:{backgroundImage:`url(${T})`,backgroundRepeat:"no-repeat",backgroundPosition:"center center",backgroundSize:"cover",minHeight:"100vh",padding:"40px 20px"},product:null,resources:[],userScore:0,newComment:"",comments:[],loading:!1,uploadDialogVisible:!1,uploadForm:{file:null,name:"",description:""},fakeAction:"http://localhost/",gatewayUrl:"http://localhost:8090"}},mounted(){const e=this.$route.params.id;e&&(this.loadProductDetail(e),this.loadResources(e),this.loadComments(e))},methods:{async loadProductDetail(e){this.loading=!0;try{const t=await f.get(`/acg-product/${e}`);if(1===t.code){const e=t.data,o={ANIME:"åŠ¨æ¼«",COMIC:"æ¼«ç”»",NOVEL:"è½»å°è¯´",GAME:"æ¸¸æˆ"};let s="";e.episodeCount?s=`${e.episodeCount}é›†`:e.chapterCount?s=`${e.chapterCount}ç« `:e.volumeCount&&(s=`${e.volumeCount}å·`),this.product={name:e.name,type:o[e.type]||e.type,author:e.author||e.developer||e.studio||"æœªçŸ¥",countDisplay:s||"æš‚æ— ",cover:e.coverPath?`${e.coverPath}`:"",totalScore:e.totalScore||0}}else this.$message.error(t.msg||"èŽ·å–äº§å“ä¿¡æ¯å¤±è´¥")}catch(t){console.error(t),this.$message.error("èŽ·å–äº§å“ä¿¡æ¯å¤±è´¥")}finally{this.loading=!1}},async loadResources(e){try{const t=await f.get(`/acg-resource/list/${e}`);1===t.code?this.resources=t.data.map(e=>({id:e.id,hasResource:!!e.resourcePath,name:e.name,description:e.description,resourcePath:e.resourcePath})):this.$message.error(t.msg||"èŽ·å–èµ„æºå¤±è´¥")}catch(t){console.error(t),this.$message.error("èŽ·å–èµ„æºå¤±è´¥")}},downloadResource(e,t){if(!e)return;const o=e.startsWith("/")?e:`/${e}`,s=`${this.gatewayUrl}${o}`,r=document.createElement("a");r.href=s,r.download=t||"èµ„æºæ–‡ä»¶",document.body.appendChild(r),r.click(),document.body.removeChild(r)},openUploadDialog(){this.uploadDialogVisible=!0,this.uploadForm={file:null,name:"",description:""}},beforeUpload(e){return this.uploadForm.file=e,!1},async submitUpload(){const e=N();if(!e)return void this.$message.error("è¯·å…ˆç™»å½•");if(!this.uploadForm.file||!this.uploadForm.name)return void this.$message.error("è¯·å¡«å†™èµ„æºåç§°å¹¶é€‰æ‹©æ–‡ä»¶");const t=new FormData;t.append("file",this.uploadForm.file),t.append("userId",e),t.append("name",this.uploadForm.name),t.append("description",this.uploadForm.description||""),t.append("productId",this.$route.params.id);try{const e=await f.post("/acg-resource/upload",t,{headers:{"Content-Type":"multipart/form-data"}});1===e.code||e.data?.id?(this.$message.success("ä¸Šä¼ æˆåŠŸ"),this.uploadDialogVisible=!1,this.uploadForm={file:null,name:"",description:""},this.loadResources(this.$route.params.id)):this.$message.error(e.msg||"ä¸Šä¼ å¤±è´¥")}catch(o){console.error(o),this.$message.error("ä¸Šä¼ å¤±è´¥")}},async submitScore(){const e=N();if(e)try{const t=await f.post("/acg-rating/rate",null,{params:{userId:e,productId:this.$route.params.id,score:this.userScore}});1===t.code?this.$message.success("è¯„åˆ†æˆåŠŸ"):this.$message.error(t.msg||"è¯„åˆ†å¤±è´¥")}catch(t){console.error(t),this.$message.error("è¯„åˆ†å¤±è´¥")}else this.$message.error("è¯·å…ˆç™»å½•")},async loadComments(e){try{const t=await f.get(`/acg-comment/list/${e}`);if(1===t.code){const e=await Promise.all(t.data.map(async e=>{if(!e.userId)return{id:e.id,username:"æœªçŸ¥ç”¨æˆ·",content:e.content};try{const t=await f.get(`/user/${e.userId}`);return{id:e.id,username:1===t.code&&t.data?t.data.userName:"æœªçŸ¥ç”¨æˆ·",content:e.content}}catch(t){return console.error(t),{id:e.id,username:"æœªçŸ¥ç”¨æˆ·",content:e.content}}}));this.comments=e}else this.$message.error(t.msg||"èŽ·å–è¯„è®ºå¤±è´¥")}catch(t){console.error(t),this.$message.error("èŽ·å–è¯„è®ºå¤±è´¥")}},async submitComment(){const e=N();if(e){if(this.newComment)try{const t=await f.post("/acg-comment/add",null,{params:{userId:e,productId:this.$route.params.id,content:this.newComment}});1===t.code?(this.newComment="",this.$message.success("è¯„è®ºæˆåŠŸ"),this.loadComments(this.$route.params.id)):this.$message.error(t.msg||"è¯„è®ºå¤±è´¥")}catch(t){console.error(t),this.$message.error("è¯„è®ºå¤±è´¥")}}else this.$message.error("è¯·å…ˆç™»å½•")}}},j=E,L=(0,n.A)(j,U,D,!1,null,"2d9be866",null),z=L.exports;s["default"].use(u.Ay);const M=[{path:"/login",name:"login",component:w},{path:"/register",name:"register",component:x},{path:"/products",name:"products",component:R},{path:"/products/:id",name:"product-detail",component:z,props:!0},{path:"/",redirect:"/login"}],V=new u.Ay({mode:"history",routes:M});var q=V,G=o(1524),H=o.n(G);s["default"].use(H()),s["default"].config.productionTip=!1,new s["default"]({router:q,render:e=>e(c)}).$mount("#app")}},t={};function o(s){var r=t[s];if(void 0!==r)return r.exports;var a=t[s]={id:s,loaded:!1,exports:{}};return e[s].call(a.exports,a,a.exports,o),a.loaded=!0,a.exports}o.m=e,function(){o.amdO={}}(),function(){var e=[];o.O=function(t,s,r,a){if(!s){var n=1/0;for(u=0;u<e.length;u++){s=e[u][0],r=e[u][1],a=e[u][2];for(var i=!0,l=0;l<s.length;l++)(!1&a||n>=a)&&Object.keys(o.O).every(function(e){return o.O[e](s[l])})?s.splice(l--,1):(i=!1,a<n&&(n=a));if(i){e.splice(u--,1);var c=r();void 0!==c&&(t=c)}}return t}a=a||0;for(var u=e.length;u>0&&e[u-1][2]>a;u--)e[u]=e[u-1];e[u]=[s,r,a]}}(),function(){o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,{a:t}),t}}(),function(){o.d=function(e,t){for(var s in t)o.o(t,s)&&!o.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){o.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e}}(),function(){o.p="/"}(),function(){var e={524:0};o.O.j=function(t){return 0===e[t]};var t=function(t,s){var r,a,n=s[0],i=s[1],l=s[2],c=0;if(n.some(function(t){return 0!==e[t]})){for(r in i)o.o(i,r)&&(o.m[r]=i[r]);if(l)var u=l(o)}for(t&&t(s);c<n.length;c++)a=n[c],o.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return o.O(u)},s=self["webpackChunkacg_project"]=self["webpackChunkacg_project"]||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))}();var s=o.O(void 0,[504],function(){return o(6479)});s=o.O(s)})();
//# sourceMappingURL=app.6c7a6bf9.js.map